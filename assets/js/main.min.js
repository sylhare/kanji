var KanjiApp=(()=>{var b=Object.defineProperty;var ce=Object.getOwnPropertyDescriptor;var ae=Object.getOwnPropertyNames;var le=Object.prototype.hasOwnProperty;var de=(e,t)=>{for(var n in t)b(e,n,{get:t[n],enumerable:!0})},ue=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of ae(t))!le.call(e,o)&&o!==n&&b(e,o,{get:()=>t[o],enumerable:!(r=ce(t,o))||r.enumerable});return e};var fe=e=>ue(b({},"__esModule",{value:!0}),e);var Me={};de(Me,{KanjiApp:()=>se});function B(e){return e.name.concat(" - ",e.reading," - ",e.meaning)}var I=(e,t)=>e.dataset.frequency-t.dataset.frequency,j=(e,t)=>t.dataset.frequency-e.dataset.frequency,l=(e,t)=>e.dataset.value-t.dataset.value,D=(e,t)=>t.dataset.value-e.dataset.value,N=(e,t)=>e.dataset.category.localeCompare(t.dataset.category),M=(e,t)=>t.dataset.category.localeCompare(e.dataset.category),T=(e,t)=>e.dataset.reading.localeCompare(t.dataset.reading),G=(e,t)=>t.dataset.reading.localeCompare(e.dataset.reading),f=function(e,t,n){return e===n?t:n};function K(e,t=200){let n=!1;return function(...r){n||(n=!0,setTimeout(()=>{e.apply(this,r),n=!1},t))}}function pe(e,t=window.innerHeight){return e.top<=t&&e.bottom>=0}function V(e,t=window.innerHeight){let n=e.getBoundingClientRect(),r=pe(n,t),o=getComputedStyle(e).display!=="none";return r&&o}function H(e){return{src:e.dataset.src,srcset:e.dataset.srcset}}function R(e,t){return e.filter(n=>n!==t)}function $(e){return e.length===0}var g=[...document.getElementsByClassName("card")],E=document.getElementById("menu-sort"),ge=document.getElementById("Number-sort"),me=document.getElementById("Frequency-sort"),ye=document.getElementById("Category-sort"),xe=document.getElementById("Reading-sort"),d=l;ge.addEventListener("click",()=>{m(D,l)});me.addEventListener("click",()=>{m(I,j)});ye.addEventListener("click",()=>{m(M,N)});xe.addEventListener("click",()=>{m(G,T)});var S=function(){g.sort(d).forEach((e,t)=>{e.style.order=t.toString()})};function m(e,t){d=f(d,e,t),S()}function he(){p.style.display="none",E.style.display=E.style.display==="flex"?"none":"flex"}var p=document.getElementById("menu-category"),ve=document.querySelectorAll(".category-filter"),C=document.getElementsByClassName("footer")[0];function we(){C.style.display=C.style.display!=="none"?"none":"block"}var be=function(){g.forEach(e=>{e.style.display="none"})};function Ee(){we(),Ae(),E.style.display="none",p.style.display=p.style.display==="flex"?"none":"flex",be(),d=l,S()}var Ce=function(e){typeof filterGraph=="function"&&filterGraph(e),g.filter(t=>t.dataset.category===e).forEach(t=>{t.style.display=t.style.display==="none"?"inline":"none"})};function Se(){C.style.display="block",p.style.display="none",g.forEach(e=>{d=l,S(),e.style.display="flex"})}var Ae=function(){ve.forEach(function(e){e.checked=!1}),typeof window.graphFilterList!="undefined"&&(window.graphFilterList=[])};function ke(e,t){for(var n=e.document||e.ownerDocument,r=n.querySelectorAll(t),o;e;){for(o=r.length-1;o>=0;){if(r.item(o)===e)return e;o-=1}e=e.parentElement}return e}var Ve=function(){"use strict";var t=document.querySelectorAll(".modal-button");t.forEach(function(o){o.onclick=function(){console.log("modal");var w=o.getAttribute("data-modal");document.getElementById(w).style.display="block"}});var n=document.querySelectorAll(".close");n.forEach(function(o){o.onclick=function(){console.log("close");var w=ke(o,".modal");w.style.display="none"}}),window.onclick=function(o){o.target.className==="modal"&&(console.log("other"),o.target.style.display="none")}}();typeof window!="undefined"&&(window.showSorts=he,window.showCategories=Ee,window.show=Ce,window.showAll=Se);var u={};function U(e){u={},e.forEach(t=>{let n=t.group;u[n]=(u[n]||0)+1})}function W(e){return u[e]||0}var A=e=>e.frequency/60,X=e=>130/e.frequency>50?50:130/e.frequency,Y=e=>e.number/10,P=e=>(215-e.number)/10;function J(e){if(!e||typeof e!="string")return 1;let t=e.toLowerCase().trim();if(t.length===0)return 1;let n=/[aeiou]+/g,o=(t.match(n)||[]).length;return t.endsWith("n")&&t.length>1&&!/[aeiou]n$/.test(t)&&(o+=1),Math.max(o,1)}var Q=e=>{let t=J(e.reading);return Math.min(t*2,28)},Z=e=>{let t=J(e.reading);return Math.min((8-t+1)*2,28)},_=e=>{let t=W(e.group);return Math.min(t,50)},ee=e=>{let t=W(e.group),n=Math.max(...Object.values(u));return Math.min(n-t+1,50)};function te(e,t){return t.includes(e)?t.filter(n=>n!==e):[...t,e]}var c=window.innerWidth||900,y=900,a,L,x=[],Le=d3.select("#graph-kanji").append("svg").attr("width",c).attr("height",y),k=d3.select("#graph-kanji").append("div").attr("class","tooltip").text("default text to be overridden"),Pe=d3.scaleOrdinal(d3.schemeCategory20),s=Le.append("g").attr("class","nodes").selectAll("g"),h=d3.forceSimulation();d3.json(jsonUrl,function(e,t){if(e)throw e;a=t,L=Object.assign({},{},t),U(a.nodes),F()});function F(){s=s.data(a.nodes,o=>o.id),s.exit().remove();let e=s.enter().append("g").attr("class","node").on("mouseover",o=>k.style("visibility","visible").text(B(o))).on("mousemove",()=>k.style("top",d3.event.pageY-10+"px").style("left",d3.event.pageX+10+"px")).on("mouseout",()=>k.style("visibility","hidden")),t=e.append("circle").attr("class",function(o){return o.group}).attr("r",q(12)).call(d3.drag().on("start",Fe).on("drag",qe).on("end",Be)),n=e.append("text").attr("class","kanji").attr("x",-8).attr("y",6).text(o=>o.name),r=e.append("title").text(o=>o.name);s=s.merge(e),Ie(),h.alpha(.3).alphaTarget(0).restart()}function Oe(e){x=te(e,x),ze(),F()}function ze(){L.nodes.forEach(function(e){e.isFilteredOut&&!x.includes(e.group)&&(e.isFilteredOut=!1,a.nodes.push(Object.assign({},{},e))),e.isFilteredOut=x.includes(e.group)}),a.nodes=L.nodes.filter(e=>!e.isFilteredOut)}function Fe(e){d3.event.active||h.alphaTarget(.3).restart(),e.fx=e.x,e.fy=e.y}function qe(e){e.fx=d3.event.x,e.fy=d3.event.y}function Be(e){d3.event.active||h.alphaTarget(0),e.fx=null,e.fy=null}function Ie(){h.nodes(a.nodes).force("center",d3.forceCenter().x(c/2).y(y/2)).force("link",d3.forceLink()).force("charge",d3.forceManyBodyReuse().strength(.001)).force("collide",d3.forceCollide().strength(1).radius(q(15)).iterations(8)).force("x",d3.forceX().strength(c<700?.2*y/c:.05)).force("y",d3.forceY().strength(c<700?.16*c/y:.05)).on("tick",()=>je(s))}function je(e){e.attr("transform",t=>"translate("+t.x+","+t.y+")")}var O=A;function q(e){return function(t){return e+O(t)}}function De(){d3.selectAll("g").select("circle").attr("r",q(12))}function v(e,t){O=f(O,e,t),F(),De()}var ne=document.getElementById("Frequency-sort"),oe=document.getElementById("Number-sort"),re=document.getElementById("Category-sort"),ie=document.getElementById("Reading-sort");ne&&ne.addEventListener("click",()=>{v(X,A)});oe&&oe.addEventListener("click",()=>{v(P,Y)});re&&re.addEventListener("click",()=>{v(_,ee)});ie&&ie.addEventListener("click",()=>{v(Q,Z)});document.addEventListener("DOMContentLoaded",function(){let e=[].slice.call(document.querySelectorAll("img.lazy"));if("IntersectionObserver"in window){let t=new IntersectionObserver(function(n,r){n.forEach(function(o){if(o.isIntersecting){let i=o.target;i.src=i.dataset.src,i.srcset=i.dataset.srcset,i.classList.remove("lazy"),t.unobserve(i)}})});e.forEach(function(n){t.observe(n)})}else Ne(e)});function Ne(e){let t=K(()=>{e.forEach(function(n){if(V(n)){let{src:r,srcset:o}=H(n);n.src=r,n.srcset=o,n.classList.remove("lazy"),e=R(e,n),$(e)&&(document.removeEventListener("scroll",t),window.removeEventListener("resize",t),window.removeEventListener("orientationchange",t))}})},200);document.addEventListener("scroll",t),window.addEventListener("resize",t),window.addEventListener("orientationchange",t)}window.filterGraph=Oe;var se={version:"2.0.0",initialized:!0};console.log("\u{1F38C} Kanji app modules loaded");typeof window!="undefined"&&(window.KanjiApp=se);return fe(Me);})();
//# sourceMappingURL=main.min.js.map

//# sourceMappingURL=main.min.js.map
